  <!DOCTYPE html>
  <html lang="ja">

  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2025 - 100%health</title>
    <link rel="stylesheet" href="/1column.css">
    <link rel="icon" type="image/svg+xml" href="/favicon.svg">
    <script src="/js/jquery-3.6.0.min.js"></script>
    <script src="/js/main.js"></script>
    <script src="/js/mouse.js"></script>
    <link rel="stylesheet" href="/txt/zakki/tag-style.css">
    <link rel="stylesheet" href="/txt/zakki/zakki-year.css">
    <script>
      $(function () {
        $("#zakkihtml").load("/txt/txt_main.html #zakki-list");
        $("#taghtml").load("/txt/txt_main.html #tag-list");
      });
    </script>
    <script>
      $(document).ready(function () {
        var yearDiv = $('#y2025');
        const year = '2025';

        // 短縮版記事を作成する関数
        function createTruncatedArticle(articleElement) {
          const truncatedArticle = document.createElement('article');
          truncatedArticle.id = articleElement.id;
          truncatedArticle.className = articleElement.className;
          
          // 見出しを保持
          const h3 = articleElement.querySelector('h3');
          if (h3) {
            const accessibleH3 = h3.cloneNode(true);
            accessibleH3.setAttribute('aria-expanded', 'false');
            truncatedArticle.appendChild(accessibleH3);
          }
          
          // 短縮版テキスト（最初の7行程度）
          const textContent = articleElement.textContent;
          const lines = textContent.split('\n').filter(line => line.trim());
          const truncatedText = lines.slice(0, 7).join('\n');
          
          const preview = document.createElement('div');
          preview.className = 'article-preview';
          preview.innerHTML = `<p>${truncatedText}...</p>`;
          truncatedArticle.appendChild(preview);
          
          // 続きを読むボタン
          const readMoreBtn = document.createElement('button');
          readMoreBtn.textContent = '続きを読む';
          readMoreBtn.className = 'read-more-btn';
          readMoreBtn.setAttribute('aria-expanded', 'false');
          readMoreBtn.setAttribute('data-article-id', articleElement.id);
          truncatedArticle.appendChild(readMoreBtn);
          
          return truncatedArticle;
        }

        // 全文記事を読み込む関数
        async function loadFullArticle(articleId, button) {
          try {
            const response = await fetch(`/txt/zakki/${year}/days/${articleId}.html`);
            if (!response.ok) return;
            
            const text = await response.text();
            const parser = new DOMParser();
            const doc = parser.parseFromString(text, 'text/html');
            const fullArticle = doc.querySelector('article');
            
            if (fullArticle) {
              const articleContainer = button.closest('article');
              articleContainer.innerHTML = fullArticle.innerHTML;
              articleContainer.setAttribute('aria-expanded', 'true');
            }
          } catch (error) {
            console.error(`Error loading full article:`, error);
          }
        }

        // 続きを読むボタンのイベント設定
        function setupReadMoreButtons(monthId) {
          const readMoreBtns = document.querySelectorAll(`#${monthId} .read-more-btn`);
          readMoreBtns.forEach(btn => {
            btn.addEventListener('click', async function() {
              const articleId = this.getAttribute('data-article-id');
              await loadFullArticle(articleId, this);
            });
          });
        }

        // 月別スクリプトを動的にロードする関数
        function loadMonthScript(month) {
          return new Promise((resolve, reject) => {
            const script = document.createElement('script');
            script.src = `/txt/zakki/${year}/${month}/zakki${month}.js`;
            script.onload = resolve;
            script.onerror = reject;
            document.body.appendChild(script);
          });
        }

        // 12ヶ月分のdiv要素を作成
        for (var i = 1; i <= 12; i++) {
          var monthId = 'm' + ('0' + i).slice(-2);
          var monthDiv = $('<div>').attr('id', monthId);
          yearDiv.append(monthDiv);
        }

        var counter = 1;
        var totalMonths = 12;

        async function loadMonth(month) {
          var paddedMonth = ('0' + month).slice(-2);
          var monthId = 'm' + paddedMonth;

          try {
            // 1. 月別HTMLの読み込み
            const response = await $.ajax({
              url: `/txt/zakki/${year}/${paddedMonth}/${year}-${paddedMonth}.html`,
              type: 'GET'
            });

            var content = $(response).find('#zakki' + paddedMonth).html();
            if (content) {
              $('#' + monthId).html(content);

              // 2. 月別スクリプトの読み込み
              await loadMonthScript(paddedMonth);

              // 3. 記事読み込み関数の実行（最適化版）
              const funcName = `loadDailyArticles${paddedMonth}`;
              if (typeof window[funcName] === 'function') {
                await window[funcName]();
                
                // 4. 短縮版の作成と続きを読むボタンの設定
                const articles = document.querySelectorAll(`#${monthId} article`);
                articles.forEach(article => {
                  const truncatedArticle = createTruncatedArticle(article);
                  article.parentNode.replaceChild(truncatedArticle, article);
                });
                setupReadMoreButtons(monthId);
              }
            }
          } catch (error) {
            console.error(`Error loading month ${paddedMonth}:`, error);
          }

          // 次の月の処理
          counter++;
          if (counter <= totalMonths) {
            await loadMonth(counter);
          }
        }

        // 1月から読み込み開始
        loadMonth(1);
      });
    </script>

  </head>

  <body>
    <div id="wrapper">
      <header id="header">
        <div id="header-flex">
          <nav id="back" aria-label="戻るナビゲーション">
            <a id="backicon" href="/index.html">
              &lt;
            </a>
          </nav>
          <nav id="address" class="addressbar" aria-label="パンくずナビゲーション">
            <a class="addressbar" href="/index.html">
              100%health
            </a>/
            <a class="addressbar" href="/txt/txt_main.html">
              txt
            </a>/
            <a class="addressbar" href="/txt/zakki/2025.html">
              2025
            </a>
          </nav>
        </div>
      </header>
      <main id="main">
        <br>
        <h1>2025年の雑記帳</h1>

        <div id="y2025">
        </div>
        
      </main>
      <footer id="main-footer">
        <div id="zakkihtml"></div>
        <div id="taghtml"></div>
        <!-- main.jsから#footerへfooter.htmlの挿入 -->
        <div id="footerhtml"></div>
      </footer>
    </div>
    <div id="lightbox">
      <link rel="stylesheet" href="/luminous-basic.min.css">
      <script src="/Luminous.min.js"></script>
      <script>
        new LuminousGallery(document.querySelectorAll('a[href$=jpg],a[href$=png],a[href$=gif],a[href$=webp]'));
      </script>
    </div>
  </body>

  </html>
